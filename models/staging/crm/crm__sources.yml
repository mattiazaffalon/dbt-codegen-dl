version: 2
sources:
  - name: crm

    tables:
      - name: feed1
        external:
            location: "gs://dbt-codegen-dl/crm/feed1/*.csv"
            options:
              format: "CSV"
              skip_leading_rows: 1
              field_delimiter: ","
        meta:
          load-strategy: scd2
          key-column: key
          timestamp-column: last_upd

        columns:
          - name: key
            data_type: string
          - name: othercolumn
            data_type: string
            meta:
              value-extract-sql: REPLACE(othercolumn, ',', '.')
              target-type: numeric
          - name: last_upd
            data_type: string
            meta:
              target-type: datetime